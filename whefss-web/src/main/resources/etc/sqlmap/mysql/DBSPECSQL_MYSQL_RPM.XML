<?xml version="1.0" encoding="GB2312"?>
<MYSQL>
	  <dynSentence name="QRY_INVD">
			<sentence>
				SELECT MERC_PSN_FLD,ITF_VER
				FROM (SELECT
				MERC_PSN_FLD,ITF_VER
				FROM RPMTINVD
				WHERE CRE_DT = ?
				AND ORD_NO = ?
				ORDER BY TM_SMP DESC) TMP
				LIMIT 0,1
			</sentence>
			<fields>CRE_DT|ORD_NO|</fields>
		</dynSentence>

		<dynSentence name="INSERT_RPMTCLRL">
			<sentence>
				INSERT INTO RPMTCLRL
				(JRN_NO,TX_CD,TX_TYP,REC_STS,CLR_STS1,CLR_STS2,MERC_ID,MERC_NM,MERC_ORD_NO,ORD_DT,MERC_PROV,MERC_CITY,MERC_CITY_NM,ORD_NO,CRE_DT,CRE_TM,ORD_TYP,MERC_TYP,POST_DT,POST_TM,TX_SYS_DT,USR_NO,USR_PROV,USR_CITY,USR_CITY_NM,MBL_NO,ORD_CAP_TYP,ORD_AMT,TXN_ATTR,MERC_DC_FLG,MCUR_AMT,CUR_CLR_FEE,CUR_CLR_CASH,CUR_CLR_CFEE,CUR_CLR_PPD,CUR_CLR_PFEE,CUR_CLR_LM,CUR_CLR_COP,MERC_RCV_AMT2,MERC_RCV_AMT3,CLR_MERC_ID,TX_MOD,FEE_TYP,CHG_FEE_FLG,FEE_DT,MERC_FEE_MOD,CNT_FEE_FLG,RFD_FEE_PRC_MOD,FEE_AC,FEE_AC_NO,FEE_AC_TYP,FEE_AC_CAP,USR_PAY_DT,USR_PAY_TM,USR_PAY_ACDT,BUS_TYP,TM_SMP,PAY_CNL)
				SELECT
				JRN_NO,'%s',TX_TYP,'%s','%s','%s',MERC_ID,CASE MERC_NM WHEN MERC_NM THEN MERC_NM ELSE ' '
				END,MERC_ORD_NO,ORD_DT,MERC_PROV,CASE MERC_CITY WHEN MERC_CITY THEN
				MERC_CITY ELSE ' ' END ,CASE MERC_CITY_NM WHEN MERC_CITY_NM THEN
				MERC_CITY_NM ELSE ' '
				END,ORD_NO,CRE_DT,CRE_TM,ORD_TYP,MERC_TYP,POST_DT,POST_TM,'%s',USR_NO,CASE
				USR_PROV WHEN USR_PROV THEN USR_PROV ELSE ' ' END ,CASE USR_CITY
				WHEN USR_CITY THEN USR_CITY ELSE ' ' END ,CASE USR_CITY_NM WHEN
				USR_CITY_NM THEN USR_CITY_NM ELSE ' ' END,CASE MBL_NO WHEN MBL_NO
				THEN MBL_NO ELSE 0 END,ORD_CAP_TYP,ORD_AMT,0,'C',MCUR_PYE_AMT,CUR_CLR_FEE,CUR_CLR_CASH,CUR_CLR_CFEE,CUR_CLR_PPD,CUR_CLR_PFEE,CUR_CLR_INV,CUR_CLR_NSTL,CUR_CLR_INV,CUR_CLR_NSTL,CLR_MERC_ID,0,FEE_TYP,CHG_FEE_FLG,FEE_DT,MERC_FEE_MOD,CASE
				CNT_FEE_FLG WHEN CNT_FEE_FLG THEN CNT_FEE_FLG ELSE ' ' END,'0',CASE
				FEE_AC WHEN FEE_AC THEN FEE_AC ELSE ' ' END,CASE FEE_AC_NO WHEN
				FEE_AC_NO THEN FEE_AC_NO ELSE ' ' END,CASE FEE_AC_TYP WHEN
				FEE_AC_TYP THEN FEE_AC_TYP ELSE ' ' END,CASE FEE_AC_CAP WHEN
				FEE_AC_CAP THEN FEE_AC_CAP ELSE ' ' END,CASE TX_SYS_DT WHEN
				TX_SYS_DT THEN CONVERT(TX_SYS_DT,CHAR) ELSE CONVERT(0,CHAR) END,CASE POST_TM
				WHEN POST_TM THEN
				CONVERT(POST_TM,CHAR) ELSE CONVERT(0,CHAR) END ,CASE POST_DT WHEN POST_DT THEN POST_DT ELSE ' ' END,BUS_TYP,DATE_FORMAT(sysdate, '%Y%m%d%H%i%S'),CASE PAY_CNL WHEN PAY_CNL THEN PAY_CNL ELSE ' ' END
				FROM RPMTBATJ
				WHERE POST_DT=? AND CLR_MERC_ID=? AND
				WAT_DEP_STS=? AND ORD_CAP_TYP=? AND MERC_FEE_MOD=? AND FEE_AC=? AND
				FEE_AC_TYP=? AND FEE_DT=? AND PAY_CNL=? AND FEE_AC_NO=? AND
				FEE_AC_CAP=? AND BUS_TYP=? AND TX_TYP=? AND CMERC_USR_NO=?                      
            </sentence>
			<fields>GWA.TX_CD|REC_STS|CLR_STS1|CLR_STS2|TX_SYS_DT|BEG_DT|CLR_MERC_ID|NWAT_DEP_STS|ORD_CAP_TYP|MERC_FEE_MOD|FEE_AC|FEE_AC_TYP|FEE_DT|PAY_CNL|FEE_AC_NO|FEE_AC_CAP|BUS_TYP|TX_TYP|CMERC_USR_NO|</fields>
		</dynSentence>
		
		<dynSentence name="UPD_RPMTRTUL">
         <sentence>           
            UPDATE
               RPMTRTUL
            SET
               RFD_STS='7'
            WHERE 
               ORD_NO=? 
               AND CRE_DT =?  
               AND RFD_APL_JRN=(
               SELECT RFD_APL_JRN 
               FROM
               (
               SELECT 
                  RFD_APL_JRN
               FROM
                  RPMTRTUL
               WHERE ORD_NO = ? AND CRE_DT = ? ORDER BY RFD_APL_DT DESC,RFD_APL_TM DESC) 
               LIMIT 0,1)
         </sentence>
         <fields>ORD_NO|CRE_DT|ORD_NO|CRE_DT</fields>
      </dynSentence>
		
		
		<dynSentence name="QRY_RPMTORD">
			<sentence>
				SELECT
				R.CRE_DT,R.CRE_TM,R.MERC_ORD_NO,R.PAY_TYP,R.ORD_STS,
				CASE WHEN R.ORD_AMT IS NULL THEN '0.00' ELSE FORMAT(R.ORD_AMT,2) END AS ORD_AMT,
				CASE WHEN A.TX_AMT1 IS NULL THEN '0.00' ELSE FORMAT(A.TX_AMT1,2) END AS TX_AMT1,
				CASE WHEN A.TX_AMT2 IS NULL THEN '0.00' ELSE FORMAT(A.TX_AMT2,2) END AS TX_AMT2,
				CASE WHEN A.TX_AMT3 IS NULL THEN '0.00' ELSE FORMAT(A.TX_AMT3,2) END AS TX_AMT3,
				CASE WHEN A.TX_AMT4 IS NULL THEN '0.00' ELSE FORMAT(A.TX_AMT4,2) END AS TX_AMT4,
				CASE WHEN R.RFD_GRS IS NULL THEN '0.00' ELSE FORMAT(R.RFD_GRS,2) END AS RFD_GRS,
				CASE WHEN R.DLR_FEE_AMT IS NULL THEN '0.00' ELSE FORMAT(R.DLR_FEE_AMT,2) END AS DLR_FEE_AMT,
				R.MBL_NO 
			   FROM RPMTORD R left join RPMTOAMT A on R.ORD_NO = A.ORD_NO 
				WHERE R.MERC_ID = '%s' AND CONCAT(R.ORD_DT,R.CRE_TM) &lt;= '%s' AND CONCAT(R.ORD_DT,R.CRE_TM) &gt;= '%s' 
				AND R.ORD_STS NOT IN ('AA','BA') 
				 ORDER BY R.ORD_NO DESC
			</sentence>
			<fields>MERC_ID|END_DTTM|BEG_DTTM|</fields>
		</dynSentence>
		
		<dynSentence name="QRY_ORDERBY_DT">
			<sentence>
				SELECT GOODS_NM,MERC_ORD_NO,ORD_AMT,ORD_DT,MERC_NM 
				FROM (SELECT
				GOODS_NM,MERC_ORD_NO,ORD_AMT,ORD_DT,MERC_NM FROM
				RPMTORD WHERE
			    USR_NO=? AND (ORD_STS='AD' OR ORD_STS='BD') 
			     ORDER BY CRE_DT DESC,CRE_TM DESC) 
			     LIMIT 0,3
			</sentence>
			<fields>USR_NO|</fields>
		</dynSentence>
		
		<dynSentence name="SEL_RPMTMKTL">
			<sentence>
				SELECT LM_BAT_NO
				FROM (SELECT LM_BAT_NO FROM RPMTMKTL WHERE
				ORD_NO = ? AND CRE_DT = ?
				ORDER BY LM_BAT_NO DESC) C
				LIMIT 0,1
			</sentence>
			<fields>ORD_NO|CRE_DT|</fields>
		</dynSentence>
		
		<dynSentence name="IVR_SEL_RPMTORD">
			<sentence>
				SELECT * FROM(SELECT TA.* FROM(SELECT
				MERC_ORD_NO,MERC_ID,ORD_DT,ORD_AMT*100 ORD_AMT FROM RPMTORD
				WHERE 
				 USR_NO=? AND (ORD_STS=? OR ORD_STS=?) AND CONCAT(ORD_EXP_DT,ORD_EXP_TM) &gt;= ?
				 AND BUS_TYP NOT IN('0401','0402','0403','0404','0405','0406','0301') 
				ORDER BY CRE_DT DESC,CRE_TM DESC) TA 
				LIMIT 0,5 )
			</sentence>
			<fields>USR_NO|D_USRREG_STS|A_USRREG_STS|NOW_TIME</fields>
		</dynSentence>
		
		<dynSentence name="QRY_RPMTIVRORD">
			<sentence>
				SELECT A.ORD_NO,A.MERC_ORD_NO,A.MERC_ID,A.MBL_NO,
					A.CRE_DT,A.CRE_TM,A.ORD_EXP_DT,A.ORD_EXP_TM,A.ORD_AMT*100 ORD_AMT 
				FROM RPMTIVRORD A,RPMTORD B 
				WHERE A.ORD_NO &gt; ? AND CONCAT(A.CRE_DT,A.CRE_TM) &gt;= ? 
					AND A.ORD_NO = B.ORD_NO AND B.ORD_STS = ?
					LIMIT 0,? 
				ORDER BY A.ORD_NO
			</sentence>
			<fields>QRY_ORDNO|DTTM|D_USRREG_STS|QRY_RECNUM|</fields>
		</dynSentence>
		
		<dynSentence name="SEL_INVD">
			<sentence>
			   SELECT MERC_REQ_NO FROM RPMTINVD WHERE CRE_DT=? AND ORD_NO=? ORDER BY TM_SMP DESC  LIMIT 0,1
		   </sentence>
			<fields>CRE_DT|ORD_NO|</fields>
		</dynSentence>
		
		<dynSentence name="QRY_RPMTINVD">
			<sentence>
				SELECT DLV_ADDR,INV_TIT,RSV_FLD FROM RPMTINVD
				WHERE
				CRE_DT=? AND ORD_NO=? LIMIT 0,1 FOR UPDATE
         </sentence>
			<fields>CRE_DT|ORD_NO|</fields>
		</dynSentence>
		
		
		<dynSentence name="INSERT_RPMTCLRL1">
			<sentence>
				INSERT INTO RPMTCLRL
				(JRN_NO,TX_CD,TX_TYP,REC_STS,CLR_STS1,CLR_STS2,MERC_ID,MERC_NM,MERC_ORD_NO,ORD_DT,MERC_PROV,MERC_CITY,MERC_CITY_NM,ORD_NO,CRE_DT,CRE_TM,ORD_TYP,MERC_TYP,POST_DT,POST_TM,TX_SYS_DT,USR_NO,USR_PROV,USR_CITY,USR_CITY_NM,MBL_NO,ORD_CAP_TYP,ORD_AMT,TXN_ATTR,MERC_DC_FLG,MCUR_AMT,CUR_CLR_FEE,CUR_CLR_CASH,CUR_CLR_CFEE,CUR_CLR_PPD,CUR_CLR_PFEE,CUR_CLR_LM,CUR_CLR_COP,MERC_RCV_AMT2,MERC_RCV_AMT3,CLR_MERC_ID,TX_MOD,FEE_TYP,CHG_FEE_FLG,FEE_DT,MERC_FEE_MOD,CNT_FEE_FLG,RFD_FEE_PRC_MOD,FEE_AC,FEE_AC_NO,FEE_AC_TYP,FEE_AC_CAP,USR_PAY_DT,USR_PAY_TM,USR_PAY_ACDT,BUS_TYP,TM_SMP,PAY_CNL,AC_PAY_FLG)
				SELECT
				JRN_NO,'%s',TX_TYP,'%s','%s','%s',MERC_ID,CASE MERC_NM WHEN
				MERC_NM THEN MERC_NM ELSE ' '
				END,MERC_ORD_NO,ORD_DT,MERC_PROV,CASE
				MERC_CITY WHEN MERC_CITY THEN
				MERC_CITY ELSE ' ' END ,CASE
				MERC_CITY_NM WHEN MERC_CITY_NM THEN
				MERC_CITY_NM ELSE ' '
				END,ORD_NO,CRE_DT,CRE_TM,ORD_TYP,MERC_TYP,POST_DT,POST_TM,'%s',USR_NO,CASE
				USR_PROV WHEN USR_PROV THEN USR_PROV ELSE ' ' END ,CASE USR_CITY
				WHEN USR_CITY THEN USR_CITY ELSE ' ' END ,CASE USR_CITY_NM WHEN
				USR_CITY_NM THEN USR_CITY_NM ELSE ' ' END,CASE MBL_NO WHEN MBL_NO
				THEN MBL_NO ELSE 0 END
				,ORD_CAP_TYP,ORD_AMT,0,'C',MCUR_PYE_AMT,CUR_CLR_FEE,ORD_AMT-CUR_CLR_PPD-CUR_CLR_MKT_GL CUR_CLR_CASH,CUR_CLR_CFEE,CUR_CLR_PPD,CUR_CLR_PFEE,CUR_CLR_INV,CUR_CLR_NSTL,CUR_CLR_INV,CUR_CLR_NSTL,CLR_MERC_ID,0,FEE_TYP,CHG_FEE_FLG,FEE_DT,MERC_FEE_MOD,CASE
				CNT_FEE_FLG WHEN CNT_FEE_FLG THEN CNT_FEE_FLG ELSE ' ' END,'0',CASE
				FEE_AC WHEN FEE_AC THEN FEE_AC ELSE ' ' END,CASE FEE_AC_NO WHEN
				FEE_AC_NO THEN FEE_AC_NO ELSE ' ' END,CASE FEE_AC_TYP WHEN
				FEE_AC_TYP THEN FEE_AC_TYP ELSE ' ' END,CASE FEE_AC_CAP WHEN
				FEE_AC_CAP THEN FEE_AC_CAP ELSE ' ' END,CASE TX_SYS_DT WHEN
				TX_SYS_DT THEN CONVERT(TX_SYS_DT,CHAR) ELSE CONVERT(0,CHAR) END,CASE POST_TM
				WHEN POST_TM THEN
				CONVERT(POST_TM,CHAR) ELSE CONVERT(0,CHAR) END ,CASE POST_DT
				WHEN POST_DT THEN POST_DT ELSE '
				' END,BUS_TYP,DATE_FORMAT(sysdate,
				'%Y%m%d%H%i%S'),CASE PAY_CNL WHEN
				PAY_CNL THEN PAY_CNL ELSE ' '
				END,CASE CONVERT(USR_NO,CHAR) WHEN '0' THEN
				'1' ELSE '0' END
				FROM RPMTBATJ
				WHERE POST_DT =? AND CLR_MERC_ID=? AND
				WAT_DEP_STS=? AND
				ORD_CAP_TYP=? AND MERC_FEE_MOD=? AND FEE_AC=? AND
				FEE_AC_TYP=? AND
				FEE_DT=? AND PAY_CNL=? AND FEE_AC_NO=? AND
				FEE_AC_CAP=? AND BUS_TYP=?
				AND TX_TYP=? AND CMERC_USR_NO=?                      
            </sentence>
			<fields>GWA.TX_CD|REC_STS|CLR_STS1|CLR_STS2|TX_SYS_DT|NOW_AC_DT|CLR_MERC_ID|NWAT_DEP_STS|ORD_CAP_TYP|MERC_FEE_MOD|FEE_AC|FEE_AC_TYP|FEE_DT|PAY_CNL|FEE_AC_NO|FEE_AC_CAP|BUS_TYP|TX_TYP|CMERC_USR_NO|</fields>
		</dynSentence>
		
		<dynSentence name="INSERT_RPMTCLRL2">
			<sentence>
				INSERT INTO RPMTCLRL
				(JRN_NO,TX_CD,TX_TYP,REC_STS,CLR_STS1,CLR_STS2,MERC_ID,MERC_NM,MERC_ORD_NO,ORD_DT,MERC_PROV,MERC_CITY,MERC_CITY_NM,ORD_NO,CRE_DT,CRE_TM,ORD_TYP,MERC_TYP,POST_DT,POST_TM,TX_SYS_DT,USR_NO,USR_PROV,USR_CITY,USR_CITY_NM,MBL_NO,ORD_CAP_TYP,ORD_AMT,TXN_ATTR,MERC_DC_FLG,MCUR_AMT,CUR_CLR_FEE,CUR_CLR_CASH,CUR_CLR_CFEE,CUR_CLR_PPD,CUR_CLR_PFEE,CUR_CLR_LM,CUR_CLR_COP,MERC_RCV_AMT2,MERC_RCV_AMT3,CLR_MERC_ID,TX_MOD,FEE_TYP,CHG_FEE_FLG,FEE_DT,MERC_FEE_MOD,CNT_FEE_FLG,RFD_FEE_PRC_MOD,FEE_AC,FEE_AC_NO,FEE_AC_TYP,FEE_AC_CAP,USR_PAY_DT,USR_PAY_TM,USR_PAY_ACDT,BUS_TYP)
				SELECT
				JRN_NO,'%s',TX_TYP,'%s','%s','%s',MERC_ID,CASE MERC_NM WHEN MERC_NM THEN MERC_NM ELSE ' '
				END,MERC_ORD_NO,ORD_DT,MERC_PROV,CASE MERC_CITY WHEN MERC_CITY THEN
				MERC_CITY ELSE ' ' END ,CASE MERC_CITY_NM WHEN MERC_CITY_NM THEN
				MERC_CITY_NM ELSE ' '
				END,ORD_NO,CRE_DT,CRE_TM,ORD_TYP,MERC_TYP,POST_DT,POST_TM,'%s',USR_NO,CASE
				USR_PROV WHEN USR_PROV THEN USR_PROV ELSE ' ' END ,CASE USR_CITY
				WHEN USR_CITY THEN USR_CITY ELSE ' ' END ,CASE USR_CITY_NM WHEN
				USR_CITY_NM THEN USR_CITY_NM ELSE ' ' END,CASE MBL_NO WHEN MBL_NO
				THEN MBL_NO ELSE 0 END
				,ORD_CAP_TYP,ORD_AMT,0,'C',MCUR_PYE_AMT,CUR_CLR_FEE,CUR_CLR_CASH,CUR_CLR_CFEE,CUR_CLR_PPD,CUR_CLR_PFEE,CUR_CLR_INV,CUR_CLR_NSTL,CUR_CLR_INV,CUR_CLR_NSTL,CLR_MERC_ID,0,FEE_TYP,CHG_FEE_FLG,FEE_DT,MERC_FEE_MOD,CASE
				CNT_FEE_FLG WHEN CNT_FEE_FLG THEN CNT_FEE_FLG ELSE ' ' END,'0',CASE
				FEE_AC WHEN FEE_AC THEN FEE_AC ELSE ' ' END,CASE FEE_AC_NO WHEN
				FEE_AC_NO THEN FEE_AC_NO ELSE ' ' END,CASE FEE_AC_TYP WHEN
				FEE_AC_TYP THEN FEE_AC_TYP ELSE ' ' END,CASE FEE_AC_CAP WHEN
				FEE_AC_CAP THEN FEE_AC_CAP ELSE ' ' END,CASE TX_SYS_DT WHEN
				TX_SYS_DT THEN CONVERT(TX_SYS_DT,char) ELSE CONVERT(0,char) END,CASE POST_TM
				WHEN POST_TM THEN
				CONVERT(POST_TM,char) ELSE CONVERT(0,char) END ,CASE POST_DT WHEN POST_DT THEN POST_DT ELSE '
				' END,BUS_TYP
				FROM RPMTBATJ
				WHERE REG_DT &gt;=? AND REG_DT &lt;=? AND CLR_MERC_ID=? AND
				WAT_DEP_STS=? AND ORD_CAP_TYP=? AND MERC_FEE_MOD=? AND FEE_AC=? AND
				FEE_AC_TYP=? AND FEE_DT=? AND PAY_CNL=? AND FEE_AC_NO=? AND
				FEE_AC_CAP=? AND BUS_TYP=? AND TX_TYP=? AND CMERC_USR_NO=?                      
            </sentence>
			<fields>GWA.TX_CD|REC_STS|CLR_STS1|CLR_STS2|TX_SYS_DT|BEG_DT|END_DT|CLR_MERC_ID|NWAT_DEP_STS|ORD_CAP_TYP|MERC_FEE_MOD|FEE_AC|FEE_AC_TYP|FEE_DT|PAY_CNL|FEE_AC_NO|FEE_AC_CAP|BUS_TYP|TX_TYP|CMERC_USR_NO|</fields>
		</dynSentence>
		
		<dynSentence name="QRY_RPMTINVD1">
			<sentence>
				SELECT MERC_REQ_NO , BNK_RTN_URL , ITF_VER 
				FROM RPMTINVD WHERE ORD_DT=? AND MERC_ID=? AND
				MERC_ORD_NO=?  AND  MERC_GW_TYP IN ('01','04','13','14') LIMIT 0,1 
            </sentence>
			<fields>ORD_DT|MERC_ID|MERC_ORD_NO|</fields>
		</dynSentence>
		 <dynSentence name="QRY_RPMTORD_USR"><!-- RET_FLG,POT_FLG,DRW_AMT,UDRW_AMT,RED_AMT,VCH_AMT,未使用 -->
         <sentence><!-- 交易状态空 -->
            SELECT 
               RPMTORD.ORD_DT,RPMTORD.CRE_TM AS OPD_TM,RPMTORD.MERC_ID,RPMTORD.ORD_NO AS ORD_NO,RPMTORD.ORD_AMT AS TXN_AMT,
               ORD_STS,HLD_NO AS AUTH_NO,RPMTORD.MERC_NM AS MER_NM,PAY_TYP,TX_AMT4 AS VCH_AMT , TX_AMT3 AS RED_AMT ,
               TX_AMT2 AS UDRW_AMT ,TX_AMT1 AS DRW_AMT,RFD_GRS AS BCK_AMT,DLR_FEE_AMT TX_FEE,CONCAT(RPMTORD.ORD_EXP_DT,RPMTORD.ORD_EXP_TM) EXP_TM,RPMTORD.BUS_TYP,
               (CASE WHEN RPMTORD.ORD_DT &gt; 0 THEN ? ELSE '0' END) AS NOW_TIME
            FROM 
               RPMTORD
            LEFT JOIN RPMTOAMT  ON (RPMTORD.ORD_NO = RPMTOAMT.ORD_NO AND RPMTORD.CRE_DT = RPMTOAMT.CRE_DT)
            WHERE
               RPMTORD.CRE_DT &gt;= ? AND RPMTORD.CRE_DT &lt;= ? 
               AND %s
                ORD_STS NOT IN %s ORDER BY ORD_DT DESC,CRE_TM DESC
         </sentence>
         <fields>NOW_TIME|STR_DT|END_DT|SQL_IN|NOT_STS|</fields>
      </dynSentence>
	<dynSentence name="QRY_RPMTORD_USR1">
         <sentence><!-- 交易状态不为空 -->
            SELECT 
               RPMTORD.ORD_DT,RPMTORD.CRE_TM AS OPD_TM,RPMTORD.MERC_ID,RPMTORD.ORD_NO AS ORD_NO,RPMTORD.ORD_AMT AS TXN_AMT,
               ORD_STS,HLD_NO AS AUTH_NO,RPMTORD.MERC_NM AS MER_NM,PAY_TYP,TX_AMT4 AS VCH_AMT , TX_AMT3 AS RED_AMT ,
               TX_AMT2 AS UDRW_AMT ,TX_AMT1 AS DRW_AMT,RFD_GRS AS BCK_AMT,DLR_FEE_AMT TX_FEE,RPMTORD.BUS_TYP,CONCAT(RPMTORD.ORD_EXP_DT,RPMTORD.ORD_EXP_TM) EXP_TM,
               (CASE WHEN RPMTORD.ORD_DT &gt; 0 THEN ? ELSE '0' END) AS NOW_TIME
            FROM 
               RPMTORD
            LEFT JOIN RPMTOAMT  ON (RPMTORD.ORD_NO = RPMTOAMT.ORD_NO AND RPMTORD.CRE_DT = RPMTOAMT.CRE_DT)
            WHERE
               RPMTORD.CRE_DT &gt;= ? AND RPMTORD.CRE_DT &lt;= ? 
               AND %s
                 RPMTOAMT.ORD_NO = RPMTORD.ORD_NO
         </sentence>
         <fields>NOW_TIME|STR_DT|END_DT|SQL_IN</fields>
      </dynSentence>
	   <dynSentence name="QRY_RPMTORD_LISTO">  <!-- 查询进行中 -->
         <sentence>
            SELECT 
               RPMTORD.ORD_DT,RPMTORD.CRE_TM AS OPD_TM,RPMTORD.MERC_ID,RPMTORD.ORD_NO AS ORD_NO,RPMTORD.ORD_AMT AS TXN_AMT,
               ORD_STS,HLD_NO AS AUTH_NO,RPMTORD.MERC_NM AS MER_NM,PAY_TYP,TX_AMT4 AS VCH_AMT , TX_AMT3 AS RED_AMT ,
               TX_AMT2 AS UDRW_AMT ,TX_AMT1 AS DRW_AMT,RFD_GRS AS BCK_AMT,DLR_FEE_AMT TX_FEE,CONCAT(ORD_EXP_DT,ORD_EXP_TM) EXP_TM,RPMTORD.BUS_TYP,
               (CASE WHEN RPMTORD.ORD_DT &gt; 0 THEN ? ELSE '0' END) AS NOW_TIME
            FROM 
               RPMTORD
            LEFT JOIN RPMTOAMT  ON (RPMTORD.ORD_NO = RPMTOAMT.ORD_NO AND RPMTORD.CRE_DT = RPMTOAMT.CRE_DT)
            WHERE
               (ORD_STS=?  
            OR ORD_STS=? OR
            ORD_STS=? OR ORD_STS=? OR ORD_STS=? OR
            ORD_STS=? OR
            ORD_STS=? OR (ORD_STS IN %s AND CONCAT(ORD_EXP_DT,ORD_EXP_TM) &gt;=
            ?) )
               AND RPMTORD.CRE_DT &gt;= ? 
               AND RPMTORD.CRE_DT &lt;= ? 
               AND %s
                RPMTOAMT.ORD_NO = RPMTORD.ORD_NO
               ORDER BY RPMTORD.CRE_DT DESC,RPMTORD.CRE_TM DESC
         </sentence>
         <fields>NOW_TIME|D_AMTREGING_STS|D_PAYING_STS|A_AMTREGING_STS|A_PAYING_STS|A_CLOSING_STS|A_EXTENDING_STS|A_HOLDING_STS|PAY_ORD_STS|NOW_TIME|STR_DT|END_DT|SQL_IN</fields>
      </dynSentence>
	  <dynSentence name="QRY_RPMTORD_LISTF">  <!-- 失败交易 -->
         <sentence>
            SELECT 
               RPMTORD.ORD_DT,RPMTORD.CRE_TM AS OPD_TM,RPMTORD.MERC_ID,RPMTORD.ORD_NO AS ORD_NO,RPMTORD.ORD_AMT AS TXN_AMT,
               ORD_STS,HLD_NO AS AUTH_NO,RPMTORD.MERC_NM AS MER_NM,PAY_TYP,TX_AMT4 AS VCH_AMT , TX_AMT3 AS RED_AMT ,
               TX_AMT2 AS UDRW_AMT ,TX_AMT1 AS DRW_AMT,RFD_GRS AS BCK_AMT,DLR_FEE_AMT TX_FEE,CONCAT(ORD_EXP_DT,ORD_EXP_TM) EXP_TM,RPMTORD.BUS_TYP,
               (CASE WHEN RPMTORD.ORD_DT &gt; 0 THEN ? ELSE '0' END) AS NOW_TIME
            FROM 
               RPMTORD
            LEFT JOIN RPMTOAMT  ON (RPMTORD.ORD_NO = RPMTOAMT.ORD_NO AND RPMTORD.CRE_DT = RPMTOAMT.CRE_DT)
            WHERE
               (ORD_STS=? OR ORD_STS=? OR ORD_STS=? OR ORD_STS=? OR ORD_STS=? 
            OR ORD_STS=? OR (ORD_STS IN %s AND CONCAT(ORD_EXP_DT,ORD_EXP_TM) &lt; ?))
               AND RPMTORD.CRE_DT &gt;= ? 
               AND RPMTORD.CRE_DT &lt;= ? 
               AND %s
              
               RPMTOAMT.ORD_NO = RPMTORD.ORD_NO
               ORDER BY RPMTORD.CRE_DT DESC,RPMTORD.CRE_TM DESC
         </sentence>
         <fields>NOW_TIME|D_CLOSED_STS|D_CLOSING_STS|D_EXTENDING_STS|D_EXTEND_STS|A_CLOSED_STS|A_EXTEND_STS|PAY_ORD_STS|NOW_TIME|STR_DT|END_DT|SQL_IN</fields>
      </dynSentence>
	  <dynSentence name="QRY_RPMTORD_LISTA_2018230">  <!-- 查询所有订单 -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,PAY_CAP_MOD,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=? 
                ORDER BY CRE_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|</fields>
        </dynSentence>
	  <dynSentence name="QRY_RPMTORD_LISTO_2018230">  <!-- 查询进行中 (B0 B1 B2 B3 B4 A0 A1 A2 A3 A4 A9 BC BB AB AC) -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=?
                AND ORD_STS IN %s
                AND CONCAT(ORD_EXP_DT,ORD_EXP_TM) &gt;= ?
                ORDER BY ORD_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|PAY_ORD_STS|NOW_TIME|</fields>
        </dynSentence>
		<dynSentence name="QRY_RPMTORD_LISTS">  <!-- 成功交易(AD|BD|C0|ZB|AZ) -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=?
                AND (ORD_STS = ? OR ORD_STS = ? OR ORD_STS = ? OR ORD_STS = ? OR ORD_STS = ? )

                ORDER BY ORD_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|D_PAID_STS|A_PAID_STS|IN_REVERSAL_STS|PRZ_SUC_STS|A_HOLDED_STS|</fields>
        </dynSentence>
		<dynSentence name="QRY_URMTMFEE">
			<sentence>
				SELECT STL_CTL FROM URMTMFEE
				WHERE MERC_ID = ? AND FEE_TYP =
				? AND RATE_TYP=? AND CAP_TYP=?
				AND
				(CONCAT(EFF_DT,EFF_TM) &lt;= ? AND
				CONCAT(EXP_DT,EXP_TM) > ?)
			</sentence>
			<fields>FEE_MERC_ID|FEE_TYP|RATE_TYP|CAP_TYP|ACT_POST_DT|ACT_POST_DT|</fields>
		</dynSentence>
		  <dynSentence name="QRY_RPMTORD_LISTF_2018230">  <!-- 失败交易 (BE|BF|AE|AF|CC) -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=?
                AND (ORD_STS=? OR ORD_STS=? OR ORD_STS=? OR ORD_STS=? OR ORD_STS=?)
                ORDER BY ORD_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|D_CLOSED_STS|D_EXTEND_STS|A_EXTEND_STS|A_CLOSED_STS|REVERSALED_STS|</fields>
        </dynSentence>
		<dynSentence name="QRY_RPMTORD_LISTR">  <!-- 退款的交易 RQ RR R1 RP RF R9 -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=?
                AND (ORD_STS=? OR ORD_STS=? OR ORD_STS=? OR ORD_STS=? OR ORD_STS=? OR ORD_STS=?)
                ORDER BY ORD_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|RefundPend_STS|RefundRecord_STS|PartRefund_STS|FullRefund_STS|ReFundOf|ReFused_STS</fields>
        </dynSentence>
		 <dynSentence name="QRY_RPMTORD_LISTB">  <!-- 交易过期 AF BF -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=?
                AND (ORD_STS=? OR ORD_STS=?
                OR (ORD_STS IN %s AND CONCAT(ORD_EXP_DT,ORD_EXP_TM) &lt; ?))
                ORDER BY ORD_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|D_EXTEND_STS|A_EXTEND_STS|PAY_ORD_STS|NOW_TIME|</fields>
        </dynSentence>
		 <dynSentence name="QRY_RPMTORD_LISTC">  <!-- 交易关闭 AE BE -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=?
                AND (ORD_STS=? OR ORD_STS=? OR ORD_STS=?)
                ORDER BY ORD_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|D_CLOSED_STS|A_CLOSED_STS|REVERSALED_STS|</fields>
        </dynSentence>

        <dynSentence name="QRY_RPMTORD_LISTRI">  <!-- 退款已受理 RQ RR R1 -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=?
                AND (ORD_STS=? OR ORD_STS=? OR ORD_STS=?)
                ORDER BY ORD_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|RefundPend_STS|RefundRecord_STS|ReFundOf|</fields>
        </dynSentence>

        <dynSentence name="QRY_RPMTORD_LISTRD">  <!-- 退款成功 RP RF -->
            <sentence>
                SELECT CRE_DT,ORD_NO,ORD_AMT,ORD_STS,REAL_MERC_NM,BUS_TYP,
                MERC_ID,MERC_ORD_NO,ORD_DT,PAY_TYP,CRE_TM,CONCAT(ORD_EXP_DT,ORD_EXP_TM)
                EXP_TM,MBL_NO,GOODS_NM
                FROM RPMTORD
                WHERE CRE_DT>=? AND CRE_DT &lt;= ? AND USR_NO=?
                AND (ORD_STS=? OR ORD_STS=?)
                ORDER BY ORD_DT DESC,CRE_TM DESC
            </sentence>
            <fields>BEG_DT|END_DT|USR_NO|PartRefund_STS|FullRefund_STS|</fields>
        </dynSentence>
		
</MYSQL>
