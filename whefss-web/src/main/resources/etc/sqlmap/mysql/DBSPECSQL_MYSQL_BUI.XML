<?xml version="1.0" encoding="GB2312"?>
<MYSQL>
      <dynSentence name="QRY_CMMTOPLG">                            
         <sentence>
             SELECT SYS_DT,SYS_TM,CONVERT(JRN_NO,CHAR) JRN_NO,AC_DT,OPR_PROV,OPR_CITY,OPR_DEPT,OPR_ID,TX_CD,TXN_NM,IP_ADDR
               FROM CMMTOPLG PLG
          LEFT JOIN CMMTTXIF TXNIF ON TX_CD = TXN_COD
              WHERE (HEMPTY(TRIM('%s')) OR SYS_DT &gt;='%s')
                AND (OPR_ID LIKE '%%s%' OR HEMPTY(TRIM('%s')))
                AND (HEMPTY(TRIM('%s')) OR SYS_DT &lt;='%s')
                AND (JRN_NO LIKE '%%s%' OR HEMPTY(TRIM('%s')))
           ORDER BY JRN_NO desc
         </sentence>
         <fields>SYS_DTS|SYS_DTS|OPR_ID|OPR_ID|SYS_DTE|SYS_DTE|JRN_NO|JRN_NO|</fields>
      </dynSentence>
      
      <dynSentence name="QRY_ACMT_INFO">
         <sentence>
			 SELECT DATE_FORMAT(STR_TO_DATE(CONCAT(SYS_DT,SYS_TM),'%Y-%m-%d %H:%i:%S'),'%Y-%m-%d %H:%i:%S') as SYS_DT_TIM,
			 		JRN_NO,JRN_SEQ,AC_NO,CAP_TYP,AC_DT,TX_CD,BUS_TYP,DR_AMT,CR_AMT,BAL,ORD_TYP,ORD_NO,MERC_ID,VCH_NO 
			   FROM ACMTCDDT
			  WHERE JRN_NO IN (SELECT JRN_NO FROM FUNDDCIN WHERE C_SEQ_NO = ?)
			  
			 UNION ALL
			 
			 SELECT DATE_FORMAT(STR_TO_DATE(CONCAT(SYS_DT,SYS_TM),'%Y-%m-%d %H:%i:%S'),'%Y-%m-%d %H:%i:%S') as SYS_DT_TIM,
			   JRN_NO,JRN_SEQ,AC_NM,CAP_TYP,AC_DT,TX_CD,BUS_TYP,DR_AMT,CR_AMT,BAL,ORD_TYP,ORD_NO,MERC_ID,VCH_NO 
			 FROM ACMTINDT
			 LEFT JOIN ACMTINIF ON ACMTINDT.AC_NO = ACMTINIF.AC_NO
			 WHERE JRN_NO IN (SELECT JRN_NO FROM FUNDDCIN WHERE C_SEQ_NO = ?)
			  
			 ORDER BY VCH_NO,JRN_SEQ
         </sentence>
         <fields>C_SEQ_NO|C_SEQ_NO|</fields>
      </dynSentence>
      
    <dynSentence name="QRY_TOP5_FUNC">
			<sentence>
				SELECT PAG_ID,PAG_NM,PAG_URL,TM_SMP 
				FROM (SELECT USR_ID,PAG_NM,TM_SMP,PAG_ID,PAG_URL,CLICK_COUNT FROM BUITUSRACT WHERE
				USR_ID = ? ORDER BY CLICK_COUNT DESC) TMP
				LIMIT 0,5
			</sentence>
			<fields>CUR_OPR_ID</fields>
		</dynSentence>
		
		<dynSentence name="SEL_RFD">
			<sentence>
				SELECT CUR_RFD_AMT,RFD_APL_TM,MERC_PROC_DESC FROM
				(
				SELECT
				CUR_RFD_AMT,RFD_APL_TM,MERC_PROC_DESC
				FROM RPMTRTUL
				WHERE ORD_NO = ? AND CRE_DT = ? ORDER BY RFD_APL_DT DESC,RFD_APL_TM DESC) TMP
				LIMIT 0,1
         </sentence>
			<fields>ORD_NO|CRE_DT|</fields>
		</dynSentence>
		
		<dynSentence name="QRY_TAMORDLT">
         <sentence>
            SELECT ORD_NO TAM_ORD_NO,TRN_MBL_NO,ORD_DT,ORD_TM,RCV_DT,TRC_TYP,TRC_FEE,USR_FEE_DDT_FLG,
            ORD_CAP_TYP,ORD_CCY,ORD_STS,TRN_AMT,TRN_DT,TRN_PSW,RCV_MBL_NO,RCV_AMT,TRC_RMK
            FROM TAMORDLT
            WHERE (TRN_USR_NO = ? OR RCV_USR_NO = ?)
            AND (ORD_STS=? OR ? is null)
            AND (STR_TO_DATE(ORD_DT,'%Y-%m-%d') BETWEEN STR_TO_DATE(?,'%Y-%m-%d') AND STR_TO_DATE(?,'%Y-%m-%d'))
            ORDER BY ORD_DT DESC,ORD_TM DESC
         </sentence>
         <fields>USR_NO|USR_NO|ORD_STS|ORD_STS|BEG_DT|END_DT|</fields>
      </dynSentence> 
      
    <dynSentence name="QRY_URMTMFEE_MERCINF">       
			<sentence>
				SELECT A.MERC_ID,A.FEE_IAC_TYP,A.FEE_IN_AC,A.FEE_AC_CAP,
				       A.EFF_DT,A.EXP_DT,B.MERC_ABBR 
				FROM URMTMFEE A, URMTMINF B 
				WHERE A.MERC_ID = ?
				AND ? BETWEEN A.EFF_DT AND A.EXP_DT
				AND A.MERC_ID = B.MERC_ID(+)
				AND LIMIT 0,1
				ORDER BY A.EFF_DT
          </sentence>
		  <fields>MERC_ID_QRY|SYS_DT|</fields>
	</dynSentence>	
	
     <dynSentence name="QRY_ACMTACLG">
         <sentence>
	          SELECT JRN_NO,AC_OPR,AC_DT,CHK_OPR,CONCAT(AC_DT,AC_TM) AC_DTTM,AC_TX_STS,count(*) OPR_NUM 
	          FROM ACMTACLG
	          WHERE (HEMPTY(?) OR AC_OPR=?) AND  AC_TX_STS=? AND (HEMPTY(?) OR AC_DT &gt;= ?) AND (HEMPTY(?) OR AC_DT &lt;= ?)
	          GROUP BY JRN_NO,AC_OPR,AC_DT,AC_TM,CHK_OPR,AC_TX_STS
         </sentence>
         <fields>AC_OPR|AC_OPR|AC_TX_STS|G_AC_DT|G_AC_DT|L_AC_DT|L_AC_DT|</fields>
      </dynSentence>
	  
      <dynSentence name="ACMTACLG_QRY_ALL">
         <sentence>
	          SELECT JRN_NO,AC_OPR,AC_DT,CHK_OPR,CONCAT(AC_DT,AC_TM) AC_DTTM,AC_TX_STS,count(*) OPR_NUM 
	          FROM ACMTACLG
	          WHERE (HEMPTY(?) OR AC_OPR=?)  AND (HEMPTY(?) OR AC_DT &gt;= ?) AND (HEMPTY(?) OR AC_DT &lt;= ?)
	          GROUP BY JRN_NO,AC_OPR,AC_DT,AC_TM,CHK_OPR,AC_TX_STS
         </sentence>
         <fields>AC_OPR|AC_OPR|G_AC_DT|G_AC_DT|L_AC_DT|L_AC_DT|</fields>
      </dynSentence>
	  
	  <dynSentence name="QRY_T_FIN_GDCR">
         <sentence>
	          SELECT * FROM T_FIN_GDCR 
	          WHERE (C_SEQ_NO LIKE CONCAT(CONCAT('%', ? ),'%') OR HEMPTY(?))
	          AND (C_CAV_FLAG  = ? OR HEMPTY(?))
	          ORDER BY C_SEQ_NO,C_ITEM_NO 
         </sentence>
         <fields>C_SEQ_NO|C_SEQ_NO|C_CAV_FLAG|C_CAV_FLAG|</fields>
      </dynSentence>
	  
	  <dynSentence name="QRY_ACMT_INFO1">
         <sentence>
			 SELECT TO_CHAR(TO_DATE(CONCAT(SYS_DT,SYS_TM),'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') as SYS_DT_TIM,
			 		JRN_NO,JRN_SEQ,AC_NO,CAP_TYP,AC_DT,TX_CD,BUS_TYP,DR_AMT,CR_AMT,BAL,ORD_TYP,ORD_NO,MERC_ID,VCH_NO 
			   FROM ACMTCDDT
			  WHERE JRN_NO IN (SELECT JRN_NO FROM FUNDDCIN WHERE C_SEQ_NO = ?)
			  
			 UNION ALL
			 
			 SELECT TO_CHAR(TO_DATE(CONCAT(SYS_DT,SYS_TM),'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') as SYS_DT_TIM,
			   JRN_NO,JRN_SEQ,AC_NM,CAP_TYP,AC_DT,TX_CD,BUS_TYP,DR_AMT,CR_AMT,BAL,ORD_TYP,ORD_NO,MERC_ID,VCH_NO 
			 FROM ACMTINDT
			 LEFT JOIN ACMTINIF ON ACMTINDT.AC_NO = ACMTINIF.AC_NO
			 WHERE JRN_NO IN (SELECT JRN_NO FROM FUNDDCIN WHERE C_SEQ_NO = ?)
			  
			 ORDER BY VCH_NO,JRN_SEQ
         </sentence>
         <fields>C_SEQ_NO|C_SEQ_NO|</fields>
      </dynSentence>
	  
	  <dynSentence name="QRY_CAPTXNJNL">
         <sentence>
	          SELECT  * FROM  CAPTXNJNL WHERE
           	   ((HEMPTY(?)  OR MERC_ID LIKE CONCAT(CONCAT('%', ?) ,'%'))
                   AND (HEMPTY(?)  OR MERC_ORD_NO LIKE CONCAT(CONCAT('%', ?) ,'%'))
                   AND (HEMPTY(?)  OR DSK_NAM LIKE CONCAT(CONCAT('%', ?) ,'%'))
                   AND (HEMPTY(?)  OR JRN_NO  LIKE CONCAT(CONCAT('%', ? ),'%'))
                   AND (HEMPTY(?)  OR CRD_NO  LIKE CONCAT(CONCAT('%', ? ),'%'))
                   AND (HEMPTY(?)  OR CORG_NO LIKE CONCAT(CONCAT('%', ?) ,'%'))
                   AND (HEMPTY(?)  OR TXN_STS = ?)
                   AND (HEMPTY(?)  OR TXN_TYP = ?)
                   AND (ORD_DT &gt;= ? OR HEMPTY(?))
		   AND (ORD_DT &lt;= ? OR HEMPTY(?))
         </sentence>
         <fields>MERC_ID|MERC_ID|MERC_ORD_NO|MERC_ORD_NO|DSK_NAM|DSK_NAM|JRN_NO|JRN_NO|CRD_NO|CRD_NO|CORG_NO|CORG_NO|TXN_STS|TXN_STS|TXN_TYP|TXN_TYP|BEG_DT|BEG_DT|END_DT|END_DT|</fields>
      </dynSentence>
	  
	  <dynSentence name="QRY_TAMTMSFJNL">    
         <sentence>
            SELECT * FROM TAMTMSFJNL WHERE 
            (HEMPTY(?) OR MERC_ID LIKE CONCAT(CONCAT('%', ?) ,'%'))
            AND (HEMPTY(?) OR MBL_NO LIKE CONCAT(CONCAT('%', ?) ,'%'))
            AND (HEMPTY(?) OR ACC_PROP LIKE CONCAT(CONCAT('%', ?) ,'%'))
            AND (HEMPTY(?) OR BAT_NO LIKE CONCAT(CONCAT('%', ?) ,'%'))
            AND (HEMPTY(?) OR STATUS ='%s')
            AND (HEMPTY(?) OR TXN_STS ='%s')
            AND (HEMPTY(?) OR ORD_STS ='%s')
            AND (ORD_DT &gt;='%s' OR HEMPTY(?))
	    AND (ORD_DT &lt;='%s' OR HEMPTY(?)) order by tm_smp DESC
         </sentence>
         <fields>MERC_ID|MERC_ID|MBL_NO|MBL_NO|ACC_PROP|ACC_PROP|BAT_NO|BAT_NO|STATUS|STATUS|TXN_STS|TXN_STS|ORD_STS|ORD_STS|BEG_DT|BEG_DT|END_DT|END_DT|</fields>
      </dynSentence>
	  
	  <dynSentence name="QRY_RPMTLGINF">
          <sentence>
              SELECT MERC_ID,MERC_NM,LEDGER_TYP,USR_NO,L_LVL,F_MERC_ID,F_MERC_NM,F_USR_NO,L_MERC_ID,L_MERC_NM,L_USR_NO,
              SVR_STS,LEDGER_KID,LEDGER_RAT,LEDGER_AMT,CRE_OPER,(CONCAT(CONCAT(CRE_DT,''),CRE_TM)) as CRE_TIME,
              (CONCAT(CONCAT(UPD_DT,''),UPD_TM)) as END_UPD_TIME,'' as LEDGER_FEN FROM RPMTLGINF WHERE F_MERC_ID=? AND LEDGER_TYP=? AND MERC_ID != ?
          </sentence>
          <fields>F_MERC_ID|LEDGER_TYP|F_MERC_ID|</fields>
       </dynSentence>
	   
	   <dynSentence name="QRY_RPMTLGINF1">
          <sentence>
          SELECT F_MERC_ID, LEDGER_TYP, F_MERC_NM, F_USR_NO, UPD_OPER, SVR_STS, CRE_OPER,min(CONCAT(CONCAT(CRE_DT,''),CRE_TM)) as CRE_TIME,max(CONCAT(UPD_DT,'',UPD_TM)) as END_UPD_TIME               
              FROM RPMTLGINF 
              WHERE (HEMPTY(?)  OR F_MERC_ID LIKE '%s')  
              GROUP BY (F_MERC_ID, LEDGER_TYP, F_MERC_NM, F_USR_NO, UPD_OPER, SVR_STS, CRE_OPER)
          </sentence>
          <fields>F_MERC_ID|F_MERC_ID|</fields>
       </dynSentence>
	   
	   <dynSentence name="QRY_REF_DET_MSG">      
			<sentence>
				SELECT  A.MERC_ORD_NO,A.ORD_NO,A.PAY_CAP_MOD,A.GOODS_NM,A.ORD_AMT,
				B.BUS_TYP,B.REC_STS JRN_REC_STS,B.LEDGER_KID,B.F_MERC_ID,B.JRN_NO,B.RFD_APL_AMT,B.SHA_RFD_GRS,
				C.REC_STS CLRL_REC_STS,(CONCAT(CONCAT(C.TX_SYS_DT,''),C.POST_TM)) REF_TM,C.POST_DT,C.RFD_APL_JRN,C.MCUR_AMT,C.MERC_ID,C.MERC_NM
				FROM RPMTORD A ,RPMTLGJRN B ,RPMTCLRL C
				WHERE A.MERC_ORD_NO=B.MERC_ORD_NO
                                AND C.MERC_ORD_NO=B.MERC_ORD_NO
                                AND C.MERC_ID=B.MERC_ID
                                AND C.BUS_TYP = '0311'
				AND C.MERC_ID=?
				AND C.MERC_ORD_NO=?
			</sentence>
			<fields>MERC_ID|MERC_ORD_NO|</fields>
		</dynSentence>
		
		<dynSentence name="QRY_REF_MSG">      
			<sentence>
				SELECT (CONCAT(CONCAT(A.CRE_DT,''),A.CRE_TM)) AS REF_TM,A.MERC_ORD_NO,A.ORD_NO,A.PAY_CAP_MOD,A.GOODS_NM,A.ORD_AMT,
				B.BUS_TYP,B.REC_STS,B.LEDGER_KID,B.F_MERC_ID,B.JRN_NO,B.SHA_RFD_GRS,B.MERC_ID,B.MERC_NM
				FROM RPMTORD A ,RPMTLGJRN B 
				WHERE A.MERC_ORD_NO=B.MERC_ORD_NO
				AND (A.CRE_DT BETWEEN ? AND ?)
				AND (A.MERC_ORD_NO=? OR HEMPTY(?))
				AND (B.MERC_ID=? OR HEMPTY(?))
				AND (A.MERC_ORD_NO=? OR HEMPTY(?))
				AND (B.REC_STS=? OR HEMPTY(?))
				AND (B.REC_STS IN ('R','P','A'))
			</sentence>
			<fields>BEG_DT|END_DT|MERC_ORD_NO|MERC_ORD_NO|MERC_ID|MERC_ID|MERC_REF_ORD_NO|MERC_REF_ORD_NO|REC_STS|REC_STS|</fields>
		</dynSentence>
		
		<dynSentence name="QRY_RUTTPMSET">
        <sentence>     
          SELECT RUL_ID,PARM_SET_ID,
                 RUT_PARM1,(CASE WHEN RUT_PARM1='TX_AMT' AND RUT_PARM1_VAL1='*' THEN RUT_PARM1_VAL1  WHEN RUT_PARM1='TX_AMT' AND RUT_PARM1_VAL1!='*' THEN CONCAT(RUT_PARM1_VAL1,'-',RUT_PARM1_VAL2) ELSE RUT_PARM1_VAL1 END)RUT_PARM1_VAL1,
                 RUT_PARM2,(CASE WHEN RUT_PARM2='TX_AMT' AND RUT_PARM2_VAL1='*' THEN RUT_PARM2_VAL1  WHEN RUT_PARM2='TX_AMT' AND RUT_PARM2_VAL1!='*' THEN CONCAT(RUT_PARM2_VAL1,'-',RUT_PARM2_VAL2) ELSE RUT_PARM2_VAL1 END)RUT_PARM2_VAL1,
                 RUT_PARM3,(CASE WHEN RUT_PARM3='TX_AMT' AND RUT_PARM3_VAL1='*' THEN RUT_PARM3_VAL1  WHEN RUT_PARM3='TX_AMT' AND RUT_PARM3_VAL1!='*' THEN CONCAT(RUT_PARM3_VAL1,'-',RUT_PARM3_VAL2) ELSE RUT_PARM3_VAL1 END)RUT_PARM3_VAL1,
                 RUT_PARM4,(CASE WHEN RUT_PARM4='TX_AMT' AND RUT_PARM4_VAL1='*' THEN RUT_PARM4_VAL1  WHEN RUT_PARM4='TX_AMT' AND RUT_PARM4_VAL1!='*' THEN CONCAT(RUT_PARM4_VAL1,'-',RUT_PARM4_VAL2) ELSE RUT_PARM4_VAL1 END)RUT_PARM4_VAL1,
                 RUT_PARM5,(CASE WHEN RUT_PARM5='TX_AMT' AND RUT_PARM5_VAL1='*' THEN RUT_PARM5_VAL1  WHEN RUT_PARM5='TX_AMT' AND RUT_PARM5_VAL1!='*' THEN CONCAT(RUT_PARM5_VAL1,'-',RUT_PARM5_VAL2) ELSE RUT_PARM5_VAL1 END)RUT_PARM5_VAL1,
                 PARM_STS,LST_UPD_DT,LST_UPD_TLR
          FROM RUTTPMSET 
          WHERE  RUL_ID=?
        </sentence>     
        <fields>RUL_ID|</fields>
        </dynSentence>
	    
		<dynSentence name="QRY_WDCTORDR_URGENT">  
			<sentence>
				SELECT ROWNUM DETAIL_NUM,'RMB' CUR_TYP_1, '%s' AGR_PAY_DT, A.WC_TYP, A.WC_ORD_NO,
				D.LBNK_NO, D.LBNK_NM, A.CAP_CRD_NO,
				(CASE WHEN A.CAP_CRD_NM = ' ' OR A.CAP_CRD_NM = '' THEN A.USR_NM ELSE A.CAP_CRD_NM END) CAP_CRD_NM,
				E.CORG_NM, A.TM_SMP, '%s' ICBC_PAY_MOD,'工行广东省深圳分行营业部' PAYER_BNK_NAME, 
				'4000023019200955879' PAYER_CRD_NO, '深圳市壹卡会科技服务有限公司' PAYER_NAME, 
				(CASE WHEN A.WC_TYP = '11' THEN '用户提现' WHEN A.WC_TYP = '12' THEN '用户转账到银行' WHEN A.WC_TYP = '21' THEN '商户结算' WHEN A.WC_TYP = '22' THEN '商户自主结算' WHEN A.WC_TYP = '31' THEN '商户代付' WHEN A.WC_TYP = '32' THEN '商户代扣' WHEN A.WC_TYP = '41' THEN '资金调拨' WHEN A.WC_TYP = '42' THEN '认证打款' ELSE '打款' END) WC_TYP_NM, 
				A.WC_APL_AMT, (CASE A.PSN_CRP_FLG WHEN '0' THEN '个人' WHEN '0' THEN '商户' ELSE '商户' END) PSN_CRP_FLG, A.WC_ACT_AMT,
				 (CASE WHEN A.CAP_CORG = 'ICBC' THEN B.PROV_NM ELSE E.CORG_NM END ) BNK_PROV_NM, 
				 (CASE F.USR_OPR_MBL WHEN 0 THEN '' ELSE CONCAT('' , F.USR_OPR_MBL) END) USR_OPR_MBL, 
				 (CASE WHEN A.CAP_CORG = 'ICBC' THEN C.CITY_NM ELSE CONCAT(CONCAT(CONCAT(B.PROV_NM , C.CITY_NM ), 'IBPS') , D.LBNK_NO) END ) BNK_CITY_NM, 
				 (CASE WHEN A.CAP_CORG = 'ICBC' THEN '1001' ELSE '0000' END ) WC_AREA_CODE 
				 FROM WDCTORDR A , CMMTPCOP B, CMMTCCOP C , CMMTBKIN D ,CMMTORGN E ,URMTOPER F 
				 WHERE (HEMPTY(?) OR A.WC_TYP = '%s') AND (HEMPTY('%s') OR A.CAP_TYP = '%s') AND (HEMPTY('%s') OR A.AGR_PAY_DT = '%s') 
				 AND (HEMPTY(?) OR A.RUT_CORG = '%s') AND A.WC_WF_STS = 'E1' AND A.PS_APPR_STS = '3' AND A.ORD_STS != 'S8' AND A.WC_BNK_PROV = B.PROV_CD 
				 AND B.PROV_CD = C.PROV_CD AND C.CITY_CD = A.WC_BNK_CITY AND D.LBNK_NO = A.LBNK_NO AND B.PROV_CD = D.PROV_CD AND C.CITY_CD = D.CITY_CD 
				 AND A.CAP_CORG = E.CORP_ORG AND A.USR_NO = F.USR_NO
			</sentence>
			<fields>GWA.TX_DT|ICBC_PAY_MOD|WC_TYP|WC_TYP|CAP_TYP|CAP_TYP|AGR_PAY_DT|AGR_PAY_DT|RUT_CORG|RUT_CORG|
			</fields>
		</dynSentence>
		
		<dynSentence name="QRY_WDCTORDR">  
			<sentence>
				SELECT (CASE WHEN MOD(ROWNUM,200) = 0 THEN '200' WHEN
				LENGTH(MOD(ROWNUM,200)) = 1 THEN CONCAT('00' , MOD(ROWNUM,200)) WHEN
				LENGTH(MOD(ROWNUM,200)) = 2 THEN CONCAT('0' , MOD(ROWNUM,200)) ELSE
				CONCAT('' , MOD(ROWNUM,200)) END) DETAIL_NUM,
				'中国建设银行深圳分行营业部' PAYER_BNK_NAME, '6217007200003004705' PAYER_CRD_NO, '442000000'
				PAY_BNK_CODE, A.CAP_CRD_NO, (CASE WHEN A.CAP_CRD_NM = ' ' OR A.CAP_CRD_NM = '' THEN A.USR_NM ELSE A.CAP_CRD_NM END) CAP_CRD_NM ,
				(CASE WHEN A.CAP_CORG != 'CCB' THEN '' WHEN A.WC_BNK_PROV = '13' AND
				A.WC_BNK_CITY = '592' THEN '351000000' WHEN A.WC_BNK_PROV = '19' AND
				A.WC_BNK_CITY = '755' THEN '442000000' WHEN A.WC_BNK_PROV = '17' AND
				A.WC_BNK_CITY = '729' THEN '420630000' WHEN A.WC_BNK_PROV = '10' AND
				A.WC_BNK_CITY = '512' THEN '322000000' WHEN A.WC_BNK_PROV = '06' AND
				A.WC_BNK_CITY = '411' THEN '212000000' WHEN A.WC_BNK_PROV = '11' AND
				A.WC_BNK_CITY = '574' THEN '331000000' WHEN A.WC_BNK_PROV = '15' AND
				A.WC_BNK_CITY = '532' THEN '371000000' WHEN A.WC_BNK_PROV = '12'
				THEN '340000000' WHEN A.WC_BNK_PROV = '01' THEN '110000000' WHEN
				A.WC_BNK_PROV = '31' THEN '500000000' WHEN A.WC_BNK_PROV = '13' THEN
				'350000000' WHEN A.WC_BNK_PROV = '27' THEN '620000000' WHEN
				A.WC_BNK_PROV = '19' THEN '441000000' WHEN A.WC_BNK_PROV = '20' THEN
				'450000000' WHEN A.WC_BNK_PROV = '23' THEN '520000000' WHEN
				A.WC_BNK_PROV = '21' THEN '460000000' WHEN A.WC_BNK_PROV = '03' THEN
				'130000000' WHEN A.WC_BNK_PROV = '16' THEN '410000000' WHEN
				A.WC_BNK_PROV = '08' THEN '230000000' WHEN A.WC_BNK_PROV = '17' THEN
				'420000000' WHEN A.WC_BNK_PROV = '18' THEN '430000000' WHEN
				A.WC_BNK_PROV = '07' THEN '220000000' WHEN A.WC_BNK_PROV = '10' THEN
				'320000000' WHEN A.WC_BNK_PROV = '14' THEN '360000000' WHEN
				A.WC_BNK_PROV = '06' THEN '211000000' WHEN A.WC_BNK_PROV = '05' THEN
				'150000000' WHEN A.WC_BNK_PROV = '29' THEN '640000000' WHEN
				A.WC_BNK_PROV = '28' THEN '630000000' WHEN A.WC_BNK_PROV = '15' THEN
				'370000000' WHEN A.WC_BNK_PROV = '04' THEN '140000000' WHEN
				A.WC_BNK_PROV = '26' THEN '610000000' WHEN A.WC_BNK_PROV = '09' THEN
				'310000000' WHEN A.WC_BNK_PROV = '22' THEN '510000000' WHEN
				A.WC_BNK_PROV = '02' THEN '120000000' WHEN A.WC_BNK_PROV = '25' THEN
				'540000000' WHEN A.WC_BNK_PROV = '30' THEN '650000000' WHEN
				A.WC_BNK_PROV = '24' THEN '530000000' WHEN A.WC_BNK_PROV = '11' THEN
				'330000000' ELSE '501000000' END ) CAP_BNK_CODE, (CONCAT(C.CITY_NM ,
				D.LBNK_NM)) CAP_LBNK_NM, (CASE WHEN A.CAP_CORG != 'CCB' THEN '' WHEN
				A.WC_BNK_PROV = '13' AND A.WC_BNK_CITY = '592' THEN '53901' WHEN
				A.WC_BNK_PROV = '19' AND A.WC_BNK_CITY = '755' THEN '56780' WHEN
				A.WC_BNK_PROV = '17' AND A.WC_BNK_CITY = '729' THEN '55395' WHEN
				A.WC_BNK_PROV = '10' AND A.WC_BNK_CITY = '512' THEN '52541' WHEN
				A.WC_BNK_PROV = '06' AND A.WC_BNK_CITY = '411' THEN '51551' WHEN
				A.WC_BNK_PROV = '11' AND A.WC_BNK_CITY = '574' THEN '53151' WHEN
				A.WC_BNK_PROV = '15' AND A.WC_BNK_CITY = '532' THEN '54751' WHEN
				A.WC_BNK_PROV = '12' THEN '53272' WHEN A.WC_BNK_PROV = '01' THEN
				'50190' WHEN A.WC_BNK_PROV = '31' THEN '57901' WHEN A.WC_BNK_PROV =
				'13' THEN '53605' WHEN A.WC_BNK_PROV = '27' THEN '59052' WHEN
				A.WC_BNK_PROV = '19' THEN '56888' WHEN A.WC_BNK_PROV = '20' THEN
				'57151' WHEN A.WC_BNK_PROV = '23' THEN '58001' WHEN A.WC_BNK_PROV =
				'21' THEN '56901' WHEN A.WC_BNK_PROV = '03' THEN '50666' WHEN
				A.WC_BNK_PROV = '16' THEN '55039' WHEN A.WC_BNK_PROV = '08' THEN
				'51952' WHEN A.WC_BNK_PROV = '17' THEN '55351' WHEN A.WC_BNK_PROV =
				'18' THEN '55860' WHEN A.WC_BNK_PROV = '07' THEN '51651' WHEN
				A.WC_BNK_PROV = '10' THEN '52451' WHEN A.WC_BNK_PROV = '14' THEN
				'54001' WHEN A.WC_BNK_PROV = '06' THEN '51301' WHEN A.WC_BNK_PROV =
				'05' THEN '51002' WHEN A.WC_BNK_PROV = '29' THEN '59551' WHEN
				A.WC_BNK_PROV = '28' THEN '59351' WHEN A.WC_BNK_PROV = '15' THEN
				'54351' WHEN A.WC_BNK_PROV = '04' THEN '50701' WHEN A.WC_BNK_PROV =
				'26' THEN '58701' WHEN A.WC_BNK_PROV = '09' THEN '52364' WHEN
				A.WC_BNK_PROV = '22' THEN '57451' WHEN A.WC_BNK_PROV = '02' THEN
				'50202' WHEN A.WC_BNK_PROV = '25' THEN '58651' WHEN A.WC_BNK_PROV =
				'30' THEN '59763' WHEN A.WC_BNK_PROV = '24' THEN '58301' WHEN
				A.WC_BNK_PROV = '11' THEN '52854' ELSE '50001' END ) CAP_BNK_NO,
				A.WC_ACT_AMT, (CASE WHEN A.WC_TYP = '11' THEN '用户提现' WHEN A.WC_TYP =
				'12' THEN '用户转账到银行' WHEN A.WC_TYP = '21' THEN '商户结算' WHEN A.WC_TYP =
				'22' THEN '商户自主结算' WHEN A.WC_TYP = '31' THEN '商户代付' WHEN A.WC_TYP =
				'32' THEN '商户代扣' WHEN A.WC_TYP = '41' THEN '资金调拨' WHEN A.WC_TYP =
				'42' THEN '认证打款' ELSE '打款' END) WC_TYP_NM
				FROM WDCTORDR A , CMMTPCOP B, CMMTCCOP C , CMMTBKIN D ,CMMTORGN E
				WHERE (HEMPTY(?) OR A.WC_TYP = '%s') AND (HEMPTY('%s') OR A.CAP_TYP = '%s')
				AND (HEMPTY(?) OR A.AGR_PAY_DT = '%s') AND (HEMPTY('%s')  OR A.RUT_CORG = '%s')
				AND A.WC_WF_STS = 'E1' AND A.PS_APPR_STS = '3' AND A.ORD_STS != 'S8'
				AND A.WC_BNK_PROV = B.PROV_CD AND B.PROV_CD = C.PROV_CD AND C.CITY_CD = A.WC_BNK_CITY AND A.CAP_CORG = E.CORP_ORG
				AND D.LBNK_NO = A.LBNK_NO AND B.PROV_CD = D.PROV_CD AND C.CITY_CD = D.CITY_CD

			</sentence>
			<fields>WC_TYP|WC_TYP|CAP_TYP|CAP_TYP|AGR_PAY_DT|AGR_PAY_DT|RUT_CORG|RUT_CORG|
			</fields>
		</dynSentence>
		
		<dynSentence name="QRY_WDCTORDR_NO_ADD">  
			<sentence>
				SELECT (CASE WHEN MOD(ROWNUM,200) = 0 THEN '200' WHEN
				LENGTH(MOD(ROWNUM,200)) = 1 THEN CONCAT('00' , MOD(ROWNUM,200)) WHEN
				LENGTH(MOD(ROWNUM,200)) = 2 THEN CONCAT('0' , MOD(ROWNUM,200)) ELSE
				CONCAT('' , MOD(ROWNUM,200)) END) DETAIL_NUM,
				'中国建设银行深圳分行营业部' PAYER_BNK_NAME, '6217007200003004705' PAYER_CRD_NO, '442000000'
				PAY_BNK_CODE, A.CAP_CRD_NO, (CASE WHEN A.CAP_CRD_NM = ' ' OR A.CAP_CRD_NM = '' THEN A.USR_NM ELSE A.CAP_CRD_NM END) CAP_CRD_NM ,
				(CASE WHEN A.CAP_CORG != 'CCB' THEN '' WHEN A.WC_BNK_PROV = '13' AND
				A.WC_BNK_CITY = '592' THEN '351000000' WHEN A.WC_BNK_PROV = '19' AND
				A.WC_BNK_CITY = '755' THEN '442000000' WHEN A.WC_BNK_PROV = '17' AND
				A.WC_BNK_CITY = '729' THEN '420630000' WHEN A.WC_BNK_PROV = '10' AND
				A.WC_BNK_CITY = '512' THEN '322000000' WHEN A.WC_BNK_PROV = '06' AND
				A.WC_BNK_CITY = '411' THEN '212000000' WHEN A.WC_BNK_PROV = '11' AND
				A.WC_BNK_CITY = '574' THEN '331000000' WHEN A.WC_BNK_PROV = '15' AND
				A.WC_BNK_CITY = '532' THEN '371000000' WHEN A.WC_BNK_PROV = '12'
				THEN '340000000' WHEN A.WC_BNK_PROV = '01' THEN '110000000' WHEN
				A.WC_BNK_PROV = '31' THEN '500000000' WHEN A.WC_BNK_PROV = '13' THEN
				'350000000' WHEN A.WC_BNK_PROV = '27' THEN '620000000' WHEN
				A.WC_BNK_PROV = '19' THEN '441000000' WHEN A.WC_BNK_PROV = '20' THEN
				'450000000' WHEN A.WC_BNK_PROV = '23' THEN '520000000' WHEN
				A.WC_BNK_PROV = '21' THEN '460000000' WHEN A.WC_BNK_PROV = '03' THEN
				'130000000' WHEN A.WC_BNK_PROV = '16' THEN '410000000' WHEN
				A.WC_BNK_PROV = '08' THEN '230000000' WHEN A.WC_BNK_PROV = '17' THEN
				'420000000' WHEN A.WC_BNK_PROV = '18' THEN '430000000' WHEN
				A.WC_BNK_PROV = '07' THEN '220000000' WHEN A.WC_BNK_PROV = '10' THEN
				'320000000' WHEN A.WC_BNK_PROV = '14' THEN '360000000' WHEN
				A.WC_BNK_PROV = '06' THEN '211000000' WHEN A.WC_BNK_PROV = '05' THEN
				'150000000' WHEN A.WC_BNK_PROV = '29' THEN '640000000' WHEN
				A.WC_BNK_PROV = '28' THEN '630000000' WHEN A.WC_BNK_PROV = '15' THEN
				'370000000' WHEN A.WC_BNK_PROV = '04' THEN '140000000' WHEN
				A.WC_BNK_PROV = '26' THEN '610000000' WHEN A.WC_BNK_PROV = '09' THEN
				'310000000' WHEN A.WC_BNK_PROV = '22' THEN '510000000' WHEN
				A.WC_BNK_PROV = '02' THEN '120000000' WHEN A.WC_BNK_PROV = '25' THEN
				'540000000' WHEN A.WC_BNK_PROV = '30' THEN '650000000' WHEN
				A.WC_BNK_PROV = '24' THEN '530000000' WHEN A.WC_BNK_PROV = '11' THEN
				'330000000' ELSE '501000000' END ) CAP_BNK_CODE,  ' ' CAP_LBNK_NM, 
				(CASE WHEN A.CAP_CORG != 'CCB' THEN '' WHEN
				A.WC_BNK_PROV = '13' AND A.WC_BNK_CITY = '592' THEN '53901' WHEN
				A.WC_BNK_PROV = '19' AND A.WC_BNK_CITY = '755' THEN '56780' WHEN
				A.WC_BNK_PROV = '17' AND A.WC_BNK_CITY = '729' THEN '55395' WHEN
				A.WC_BNK_PROV = '10' AND A.WC_BNK_CITY = '512' THEN '52541' WHEN
				A.WC_BNK_PROV = '06' AND A.WC_BNK_CITY = '411' THEN '51551' WHEN
				A.WC_BNK_PROV = '11' AND A.WC_BNK_CITY = '574' THEN '53151' WHEN
				A.WC_BNK_PROV = '15' AND A.WC_BNK_CITY = '532' THEN '54751' WHEN
				A.WC_BNK_PROV = '12' THEN '53272' WHEN A.WC_BNK_PROV = '01' THEN
				'50190' WHEN A.WC_BNK_PROV = '31' THEN '57901' WHEN A.WC_BNK_PROV =
				'13' THEN '53605' WHEN A.WC_BNK_PROV = '27' THEN '59052' WHEN
				A.WC_BNK_PROV = '19' THEN '56888' WHEN A.WC_BNK_PROV = '20' THEN
				'57151' WHEN A.WC_BNK_PROV = '23' THEN '58001' WHEN A.WC_BNK_PROV =
				'21' THEN '56901' WHEN A.WC_BNK_PROV = '03' THEN '50666' WHEN
				A.WC_BNK_PROV = '16' THEN '55039' WHEN A.WC_BNK_PROV = '08' THEN
				'51952' WHEN A.WC_BNK_PROV = '17' THEN '55351' WHEN A.WC_BNK_PROV =
				'18' THEN '55860' WHEN A.WC_BNK_PROV = '07' THEN '51651' WHEN
				A.WC_BNK_PROV = '10' THEN '52451' WHEN A.WC_BNK_PROV = '14' THEN
				'54001' WHEN A.WC_BNK_PROV = '06' THEN '51301' WHEN A.WC_BNK_PROV =
				'05' THEN '51002' WHEN A.WC_BNK_PROV = '29' THEN '59551' WHEN
				A.WC_BNK_PROV = '28' THEN '59351' WHEN A.WC_BNK_PROV = '15' THEN
				'54351' WHEN A.WC_BNK_PROV = '04' THEN '50701' WHEN A.WC_BNK_PROV =
				'26' THEN '58701' WHEN A.WC_BNK_PROV = '09' THEN '52364' WHEN
				A.WC_BNK_PROV = '22' THEN '57451' WHEN A.WC_BNK_PROV = '02' THEN
				'50202' WHEN A.WC_BNK_PROV = '25' THEN '58651' WHEN A.WC_BNK_PROV =
				'30' THEN '59763' WHEN A.WC_BNK_PROV = '24' THEN '58301' WHEN
				A.WC_BNK_PROV = '11' THEN '52854' ELSE '50001' END ) CAP_BNK_NO,
				A.WC_ACT_AMT, (CASE WHEN A.WC_TYP = '11' THEN '用户提现' WHEN A.WC_TYP =
				'12' THEN '用户转账到银行' WHEN A.WC_TYP = '21' THEN '商户结算' WHEN A.WC_TYP =
				'22' THEN '商户自主结算' WHEN A.WC_TYP = '31' THEN '商户代付' WHEN A.WC_TYP =
				'32' THEN '商户代扣' WHEN A.WC_TYP = '41' THEN '资金调拨' WHEN A.WC_TYP =
				'42' THEN '认证打款' ELSE '打款' END) WC_TYP_NM
				FROM WDCTORDR A 
				WHERE (HEMPTY(?) OR A.WC_TYP = '%s') AND (HEMPTY('%s')  OR A.CAP_TYP = '%s')
				AND (HEMPTY(?) OR A.AGR_PAY_DT = '%s') AND (HEMPTY('%s') OR A.RUT_CORG = '%s')
				AND A.WC_WF_STS = 'E1' AND A.PS_APPR_STS = '3' AND A.ORD_STS != 'S8'
			</sentence>
			<fields>WC_TYP|WC_TYP|CAP_TYP|CAP_TYP|AGR_PAY_DT|AGR_PAY_DT|RUT_CORG|RUT_CORG|
			</fields>
		</dynSentence>
	   
	 
</MYSQL>
